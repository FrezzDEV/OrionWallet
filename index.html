<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–§–∏–æ–ª–µ—Ç–æ–≤–æ–µ –º–µ–Ω—é —Å –±–∞–ª–∞–Ω—Å–æ–º –∏ –∑–∞—è–≤–∫–∞–º–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: #0a0a0a;
            color: white;
        }

        /* –°—Ç–∏–ª–∏ –±—É—Ä–≥–µ—Ä-–º–µ–Ω—é */
        .menu-toggle {
            position: fixed;
            top: 25px;
            left: 25px;
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
        }

        .bar {
            width: 30px;
            height: 3px;
            background: #8A2BE2;
            margin: 6px 0;
            transition: 0.4s;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –±—É—Ä–≥–µ—Ä–∞ –≤ –∫—Ä–µ—Å—Ç–∏–∫ */
        .menu-toggle.active .bar:nth-child(1) {
            transform: rotate(-45deg) translate(-6px, 6px);
        }

        .menu-toggle.active .bar:nth-child(2) {
            opacity: 0;
        }

        .menu-toggle.active .bar:nth-child(3) {
            transform: rotate(45deg) translate(-6px, -6px);
        }

        /* –°—Ç–∏–ª–∏ –±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é */
        .sidebar {
            position: fixed;
            left: -300px;
            top: 0;
            width: 320px;
            height: 100%;
            background: #1a1a1a;
            padding: 80px 25px 25px;
            transition: 0.3s;
            box-shadow: 4px 0 15px rgba(138, 43, 226, 0.2);
            overflow-y: auto;
        }

        .sidebar.active {
            left: 0;
        }

        /* –°—Ç–∏–ª–∏ –ø—É–Ω–∫—Ç–æ–≤ –º–µ–Ω—é */
        .menu-item {
            color: white;
            text-decoration: none;
            padding: 15px;
            margin: 10px 0;
            display: block;
            border-radius: 8px;
            transition: 0.3s;
            position: relative;
            overflow: hidden;
            background: #222;
        }

        .menu-item:before {
            content: '';
            position: absolute;
            left: -100%;
            top: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                rgba(138, 43, 226, 0) 0%,
                rgba(138, 43, 226, 0.2) 50%,
                rgba(138, 43, 226, 0) 100%
            );
            transition: 0.5s;
            z-index: 0;
        }

        .menu-item:hover {
            background: #2d2d2d;
            transform: translateX(10px);
        }

        .menu-item:hover:before {
            left: 100%;
        }

        .menu-item span {
            position: relative;
            z-index: 1;
            display: block;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –≤–Ω—É—Ç—Ä–∏ –º–µ–Ω—é */
        .menu-header {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1em;
            border-bottom: 1px solid #8A2BE2;
            padding-bottom: 5px;
        }
    </style>
</head>
<body>
    <!-- –ë—É—Ä–≥–µ—Ä-–º–µ–Ω—é -->
    <div class="menu-toggle" aria-label="Toggle menu" role="button" tabindex="0">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
    </div>

    <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
    <nav class="sidebar" aria-label="Sidebar menu">
        <a href="#" class="menu-item" id="profile-item">üë§ –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è...</a>
        <a href="#" class="menu-item" id="balance-item">üí∞ –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–ª–∞–Ω—Å–∞...</a>
        <a href="#" class="menu-item" id="withdrawals-item">
            üìù –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...
        </a>
        <a href="#" class="menu-item">üí≥ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</a>
        <a href="#" class="menu-item">üõç –ú–∞–≥–∞–∑–∏–Ω</a>
    </nav>

    <script>
        const menuToggle = document.querySelector('.menu-toggle');
        const sidebar = document.querySelector('.sidebar');

        menuToggle.addEventListener('click', () => {
            menuToggle.classList.toggle('active');
            sidebar.classList.toggle('active');
        });

        // –ü—Ä–∏–º–µ—Ä user_id –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ ‚Äî –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –Ω—É–∂–Ω–æ –±—Ä–∞—Ç—å –∏–∑ —Å–µ—Å—Å–∏–∏ –∏–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        // –ü–æ–∫–∞ —É–∫–∞–∂–µ–º –¥–ª—è —Ç–µ—Å—Ç–∞ user_id=123 (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –∏–ª–∏ –ø–æ–ª—É—á–∞–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏)
        const USER_ID = 123;

        async function fetchUserData() {
            try {
                const res = await fetch('/api/users');
                if (!res.ok) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
                const users = await res.json();
                return users;
            } catch (e) {
                console.error(e);
                return null;
            }
        }

        async function fetchWithdrawalsSummary() {
            try {
                const res = await fetch('/api/withdrawals-summary');
                if (!res.ok) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫');
                const summary = await res.json();
                return summary;
            } catch (e) {
                console.error(e);
                return null;
            }
        }

        async function updateMenu() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            const users = await fetchUserData();
            const withdrawals = await fetchWithdrawalsSummary();

            // –ù–∞–π–¥—ë–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø—Ä–∏–º–µ—Ä, —É —Ç–µ–±—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ user_id)
            const user = users ? users.find(u => u.user_id === USER_ID) : null;

            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å (user_id + Telegram ID)
            const profileEl = document.getElementById('profile-item');
            if (user) {
                profileEl.textContent = `üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ID: ${user.user_id}`;
            } else {
                profileEl.textContent = 'üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω';
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
            const balanceEl = document.getElementById('balance-item');
            if (user) {
                balanceEl.textContent = `üí∞ –ë–∞–ª–∞–Ω—Å: ${user.balance} –±–∞–ª–ª–æ–≤`;
            } else {
                balanceEl.textContent = 'üí∞ –ë–∞–ª–∞–Ω—Å: -';
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥
            const withdrawEl = document.getElementById('withdrawals-item');
            if (withdrawals) {
                withdrawEl.innerHTML = `üìù –ó–∞—è–≤–æ–∫: ${withdrawals.requests_count}<br>
                    –ë–∞–ª–ª–æ–≤ –≤—Å–µ–≥–æ: ${withdrawals.total_points}<br>
                    –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞: $${withdrawals.total_usd}`;
            } else {
                withdrawEl.textContent = 'üìù –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫';
            }
        }

        updateMenu();
        // –û–±–Ω–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)
        setInterval(updateMenu, 30000);
    </script>
</body>
</html>
